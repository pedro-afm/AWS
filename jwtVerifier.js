const { CognitoJwtVerifier } = require('aws-jwt-verify');

// Import dotenv for loading environment variables from a .env file
const dotenv = require('dotenv');
dotenv.config();

const tokenVerifier = async function (token) {
  const verifier = CognitoJwtVerifier.create({
    userPoolId: process.env.UserPoolId,
    tokenUse: 'access',
    clientId: process.env.ClientId,
  });

  try {
    const payload = await verifier.verify(token);
    console.log('Token is valid. Payload: ', payload);
  } catch (e) {
    console.log('Token is invalid');
  }
};

const token = {
    '$metadata': {
      httpStatusCode: 200,
      requestId: '5353a8f2-783c-4083-957d-ba6fd3a8266b',
      extendedRequestId: undefined,
      cfId: undefined,
      attempts: 1,
      totalRetryDelay: 0
    },
    AuthenticationResult: {
      AccessToken: 'eyJraWQiOiJiRmZRV0l6SnQzN1JySUV5bkJTeURkYmQ0Zm41QmprTTBIaTZKOE5HNmt3PSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI3MDM1ZDdmZi01ZjkyLTQ0YzEtOTAyOS03NGM4ZDlkZDk0MmIiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtbm9ydGgtMS5hbWF6b25hd3MuY29tXC9ldS1ub3J0aC0xX2N0bHZYblJTQiIsImNsaWVudF9pZCI6IjdpYWNlbmFzNjZqbTlvZG5wa2xyZGZpZWdnIiwib3JpZ2luX2p0aSI6IjU5OTFkY2JkLTY1MTYtNDAxNC1hNjA1LWE0ZGQ5NmM3Yjc1ZSIsImV2ZW50X2lkIjoiNTM1M2E4ZjItNzgzYy00MDgzLTk1N2QtYmE2ZmQzYTgyNjZiIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbiIsImF1dGhfdGltZSI6MTcwNjc4MzI0OSwiZXhwIjoxNzA2Nzg2ODQ5LCJpYXQiOjE3MDY3ODMyNDksImp0aSI6ImM1NWRjMjNhLWFmNWMtNDAxNC1iZTNmLWZhNDVlZmE1NjIzYyIsInVzZXJuYW1lIjoiNzAzNWQ3ZmYtNWY5Mi00NGMxLTkwMjktNzRjOGQ5ZGQ5NDJiIn0.SViS6ZoukfGQZ6cVr0EDzhXBZ4pE2bOeeIW603UHE3QgZkhsag8AJn9AykbXxc520y7CH6f7wib2lKgWRZMhky_T2kIJRjojgWk18gdkHmkX85bIiFfkINC9yyMyLTMWM7afiX1uTqQiuOb327cVFz_Ag1z4SxOXs3ZJYAZym2FTonP2xwOX1uqps64Hcf9y7rlgu3WrCfVAv1DQe7XQqJTsJiXKOwUK0o5kAFwIPQJDIClTocNuOe8W6fAPLNX90TCcjhYDzSRZ4zEznWqhguOtavdgWZfAu1CLaVbIQ8AcKzdKbajm3If9vEE03Zh2JvaK99DMiAWdbmT4AHGvIQ',
      ExpiresIn: 3600,
      IdToken: 'eyJraWQiOiJhT0VjQkxsOVlcLzhPVmZJOTYyZStZRkV6cnhUK0RUWTNnKzVvbU1oUXR2ND0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiI3MDM1ZDdmZi01ZjkyLTQ0YzEtOTAyOS03NGM4ZDlkZDk0MmIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LW5vcnRoLTEuYW1hem9uYXdzLmNvbVwvZXUtbm9ydGgtMV9jdGx2WG5SU0IiLCJjb2duaXRvOnVzZXJuYW1lIjoiNzAzNWQ3ZmYtNWY5Mi00NGMxLTkwMjktNzRjOGQ5ZGQ5NDJiIiwib3JpZ2luX2p0aSI6IjU5OTFkY2JkLTY1MTYtNDAxNC1hNjA1LWE0ZGQ5NmM3Yjc1ZSIsImF1ZCI6IjdpYWNlbmFzNjZqbTlvZG5wa2xyZGZpZWdnIiwiZXZlbnRfaWQiOiI1MzUzYThmMi03ODNjLTQwODMtOTU3ZC1iYTZmZDNhODI2NmIiLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTcwNjc4MzI0OSwiZXhwIjoxNzA2Nzg2ODQ5LCJpYXQiOjE3MDY3ODMyNDksImp0aSI6ImE0YjZjYzIwLWFkM2EtNDQ2NC04OTZkLTdmOGZkYmNmODE4YiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20ifQ.Li6wBCYl4BxedPtaehSpOosyW5tecIDQtoCESomkVAJJuEak1-9pvBOYRNa66ns-fPxoQAauyFut1We7E6cfo1qhoHcVad95zq8lmKDol3XDWVLtOvlENHOerF-9C8y5nCgAv95Z39O3snSnxv1UnUyBQ7oEpjElZMJvvvQx5amjJc8rjaaw07pJSpb1ZD_rmroFe9NUnik78i-512b_taR20L7jiRWPA23pfdsZUMByW9qgbXROFDg8bJDCZYpGnPr6b7-KBkIpNw50pTSb1y0YtiClCpr9xRUAYvIhB0YLWD4FVxqeIQrcf38Mo4LMOefU1jDydPStsERXurz-YA',
      RefreshToken: 'eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.REqmOS-FkkK-iPD0a0eYsZ7ZBYXAt2D7IIAl3cAjrluPJxl-Sd-euukVS5BmkBDXX5muszSm5tFheohy6gCxJ-ZdpieX3boeqO3L_9SE1EjGgkUAtm_cgRBqP76H-TvvfA5VVSXjhN9woAPZb6g7PzlRgyXUOWx2-WJ1nMth2EeQ9dpNOmfhTtnefbYTdmE8yMGMsqG8y0KqccmYryx6U65y4tPmGQpWW8SUaH5IvFJotFHT1nHN2_8rf14htJ3jRK5yBUimoHfBe6t48tTC6zk4iRK7rrYe3HvsDWHlQunzJI9VK5X2TvdnjTgLsehB6oNS3f9svV4nPbltkRpYCA.xJKKLRHsjHvNBUml.t6sc_Nrg75wxaiTJiRyR2yEWWFr0XUgp8baLX8xW0Ly9D6NJOXC2FxAevmY428rZSuE8OeEqK0NhKFq7j8TDIhNM0-LnLwK_4aPJwn5pmP5_ACg0zAIPp_gkVmHefYpFEUHCULPxb239Z73EzfqbibyeuCO0T8bdzQOrBAUBPxB4ljIk2ER44-ve9mIf6mdLBHiy6N0Soxczs528chNwGu313oLZcPu7gs1vbfYvcjSG9foo0oBjKO2NyQ1gDQAUlJbO7qjgCRKZQkUufAOCmmvJe4vH0SLt4p-PxVHsQPC7OBrkp4RPmuSphYaRC0QOLQwmKtmlvFfRThT2YwOuD5TqM8R3RD1nRXtse4SMxQfSPoMX901NEVqFDg8N_wtlgmhXJwntLb0aP4iLiQ0HzXITocg0SYq5qLskcwXaHRqhr7-rVyyIiLx-Y_1Ki38swS9QVeduZvb89CR3_vsJSsuoFs2x2aPe2ssVhSQThORnx9YHy29g3we2Wg5a4LTLV6QWyaWWNL-OtY9Ww5yBkdOXJ_Ykcs3pHgQnYLH9-vsWNWpzuhc3wSri6EkroyI3JOmQNz5J1Wt7-ZOTtO7oN5a0d6N5u6KxEP-mirnSlZOLie418SWb2LjPbf6b71v4mFBCEOfAC4zfikTc6D8_wjD5RzLvokkNkjDpK5nDFmjPEJX2WYZRQOjDLWBJ_ANeopwwfpK5KYDrodIJE-5sJ5plYRTWM-kOjzoyrJ1qQKzGu1GKqx9FvT5haQfFi7byF8MM8JVX2V64GWZTIA6CXhBsJVm0rPtmxGmxfk9vexMf89nFVUQ3iZbtj6x5g5dv7nh8NcLoAPPEOtm4MCt1QCzUIiN46hdqvO9p0HA1HNQs6vqnbwnsu_N4jVTY3fs5oQsw8OyxLq6wl-C4fIZq9Ht_zZ2SUABEXSSP5LAlYhQUblZccLtryjkIrFnWfxep2vGujUkStf-VD0KcIu5hgFvS0iZnxRiIBKGdnjpp26TlSwLEXKiZt6RyB0Jpi9REB9w6w8Zapj3NR8r2Bm_kVEjlDcRPVRCobHCcnL0HIBzSwG7XxfIRtnPlkOaog46asB_sXTN77VG6w9d65Nqh7qMzHtlp-HDc_4TB_XKsfZg66bBWyDEkgWGGujBVrEHDjrCTNP-0GsfHPGfppRg-pEjAUlz7QblxsisXILzu_Gd7DMoC7MD3Db1kUBWEzb3pVY1FhJQDkALB55XLCM72Co4lmVt979yNihAvP8xog51NFucAtApRE4viYoduUzA6IU9X0gc8Jr8591oH7mA7-gT7rmy5ESRoR1uOsjsI-NmEeegERR5PE9RAA9ase8s.yGa28W6kwYhNx1HlBjetEg',
      TokenType: 'Bearer'
    },
    ChallengeParameters: {}
  }

  tokenVerifier(token.AuthenticationResult.AccessToken);